<div class="sheet-container">
    <div class ="sheet-item-header">
        <input type='hidden' class='controller_d12_1' name='attr_controller_d12_1' value='one'>
        <input type='hidden' class='controller_d12_2' name='attr_controller_d12_2' value='one'>
        <input type='hidden' class='controller_d10_1' name='attr_controller_d10_1' value='one'>
        <input type='hidden' class='controller_d10_2' name='attr_controller_d10_2' value='one'>
        <input type='hidden' class='controller_d8_1' name='attr_controller_d8_1' value='one'>
        <input type='hidden' class='controller_d8_2' name='attr_controller_d8_2' value='one'>
        <input type='hidden' class='controller_d8_3' name='attr_controller_d8_3' value='one'>
        <input type='hidden' class='controller_d6_1' name='attr_controller_d6_1' value='one'>
        <input type='hidden' class='controller_d6_2' name='attr_controller_d6_2' value='one'>
        <input type='hidden' class='controller_d4_1' name='attr_controller_d4_1' value='one'>
        <input type='hidden' class='controller_d4_2' name='attr_controller_d4_2' value='one'>
        <input type='hidden' class='controller_d4_3' name='attr_controller_d4_3' value='one'>
        
        <input type='hidden' class='resource_d10_1' name='attr_resource_d10_1' value='one'>
        <input type='hidden' class='resource_d10_2' name='attr_resource_d10_2' value='one'>
        <input type='hidden' class='resource_d10_3' name='attr_resource_d10_3' value='one'>
        <input type='hidden' class='resource_d10_4' name='attr_resource_d10_4' value='one'>
        <input type='hidden' class='resource_d10_5' name='attr_resource_d10_5' value='one'>
        <input type='hidden' class='resource_d10_6' name='attr_resource_d10_6' value='one'>
        <input type='hidden' class='resource_d8_1' name='attr_resource_d8_1' value='one'>
        <input type='hidden' class='resource_d8_2' name='attr_resource_d8_2' value='one'>
        <input type='hidden' class='resource_d8_3' name='attr_resource_d8_3' value='one'>
        <input type='hidden' class='resource_d8_4' name='attr_resource_d8_4' value='one'>
        <input type='hidden' class='resource_d8_5' name='attr_resource_d8_5' value='one'>
        <input type='hidden' class='resource_d8_6' name='attr_resource_d8_6' value='one'>
        <input type='hidden' class='resource_d6_1' name='attr_resource_d6_1' value='one'>
        <input type='hidden' class='resource_d6_2' name='attr_resource_d6_2' value='one'>
        <input type='hidden' class='resource_d6_3' name='attr_resource_d6_3' value='one'>
        <input type='hidden' class='resource_d6_4' name='attr_resource_d6_4' value='one'>
        <input type='hidden' class='resource_d6_5' name='attr_resource_d6_5' value='one'>
        <input type='hidden' class='resource_d6_6' name='attr_resource_d6_6' value='one'>
        
        <Span class="sheet-header1">Dice Pool</Span>
        <div class="sheet-header2">Main dice</div>
        <div class='diceblock'>
            <span class='receiver_d12_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d12_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="60" height="60" border="0" align="middle" /></span>
			<span class='receiver_d10_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
			<span class='receiver_d10_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d8_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d8_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d8_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d6_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d6_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d4_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d4_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d4_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="60" height="60" border="0" align="middle" /></span>
        </div>
        <Span class="sheet-header2">Resources dice</Span>
        <div class='diceblock'>
            <span class='rresource_d10_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d10_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
    		<span class='rresource_d10_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
    		<span class='rresource_d10_4'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
    		<span class='rresource_d10_5'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
    		<span class='rresource_d10_6'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_4'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_5'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_6'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_4'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_5'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_6'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
        </div>
    </div>
    <div class ="sheet-item-plot">
        <input name='attr_main_dice' type='hidden' value='{}'>
        <input name='attr_main_diceroll' type='hidden' value='{"d4":0,"d6":0,"d8":0,"d10":0,"d12":0}'>
        <input name='attr_resource_dice' type='hidden' value='{}'>
        <input name='attr_resource_diceroll' type='hidden' value='{"d4":0,"d6":0,"d8":0,"d10":0,"d12":0}'>
        <input name='attr_stress_dice' type='hidden' value='{}'> 
        <div class="sheet-header2">Plot points available
            <span class = "sheet-plot_point_container" name="attr_plot_points"></span><input name='attr_plot_points' type='hidden' value=0>
        </div>
    </div>
    <div class ="sheet-item-roll">
            <div class="sheet-header2">Plot points to spend on roll
                <input name='attr_plot_points_spent' type='text' value=0>
                <button class="sheet-cortex_roll" type="roll" value="!cortex_custom_roll" name="call_cortex_roll">Cortex roll</button>
            </div>
    </div>
    <div class ="sheet-item-affiliations_title sheet-rotated">Affiliations</div>
    <div class ="sheet-griditem sheet-item-affiliations_body">
        <ul>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_affiliation" value="solo">Solo</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_solo" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_solo" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_solo" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_solo" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_solo" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_affiliation" value="partner">Partner</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_partner" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_partner" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_partner" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_partner" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_partner" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_affiliation" value="squad">Squad</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_squad" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_squad" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_squad" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_squad" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_squad" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
        </ul> 
    </div>
    <div class ="sheet-item-distinctions_title sheet-rotated">Distinctions</div>
    <div class ="sheet-griditem sheet-item-distinctions_body">
        <ul>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_distinction" value="distinction1"><input type="text" name="attr_distinction1_txt"/></label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_distinction1" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_distinction1" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_distinction" value="distinction2"><input type="text" name="attr_distinction2_txt"/></label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_distinction2" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_distinction2" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_distinction" value="distinction3"><input type="text" name="attr_distinction3_txt"/></label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_distinction3" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_distinction3" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			    <label class="sheet-dicepicker2"><input type="radio" name="attr_distinction" value="distinction4">No distinction used</label>
			    <input name='attr_distinction4' type="hidden" value='0'>
			<li>
			    
			</li>
		</ul>
    </div>
    <div class ="sheet-item-roles_title sheet-rotated">Roles</div>
    <div class ="sheet-griditem sheet-item-roles_body">
        <ul>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="forensics">Forensics</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_forensics" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_forensics" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_forensics" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_forensics" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_forensics" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="investigation">Investigation</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_investigation" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_investigation" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_investigation" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_investigation" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_investigation" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="legal">Legal</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_legal" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_legal" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_legal" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_legal" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_legal" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="medicine">Medicine</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_medicine" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_medicine" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_medicine" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_medicine" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_medicine" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="psychology">Psychology</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_psychology" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_psychology" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_psychology" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_psychology" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_psychology" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="tactics">Tactics</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_tactics" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_tactics" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_tactics" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_tactics" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_tactics" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="technology">Technology</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_technology" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_technology" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_technology" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_technology" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_technology" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
        </ul> 
    </div>
    <div class ="sheet-item-talents_title sheet-rotated">Talents</div>
    <div class ="sheet-griditem sheet-item-talents_body">
        <ul>
            <li><label class="sheet-dicepicker"><input type="text" name="attr_talent1"/></label></li>
            <li><label class="sheet-dicepicker"><input type="text" name="attr_talent2"/></label></li>
            <li><label class="sheet-dicepicker"><input type="text" name="attr_talent3"/></label></li>
        </ul>
    </div>
    <div class ="sheet-item-resources_title sheet-rotated">Resources</div>
    <div class ="sheet-griditem sheet-item-resources_body">
        <input type='hidden' class="sheet-activate_r1a" name="attr_controller_resource1a" value='active'>
        <input type='hidden' class="sheet-activate_r1b" name="attr_controller_resource1b" value='active'>
        <input type='hidden' class="sheet-activate_r2a" name="attr_controller_resource2a" value='active'>
        <input type='hidden' class="sheet-activate_r2b" name="attr_controller_resource2b" value='active'>
        <input type='hidden' class="sheet-activate_r3a" name="attr_controller_resource3a" value='active'>
        <input type='hidden' class="sheet-activate_r3b" name="attr_controller_resource3b" value='active'>
        <input type='hidden' class="sheet-activate_r4a" name="attr_controller_resource4a" value='active'>
        <input type='hidden' class="sheet-activate_r4b" name="attr_controller_resource4b" value='active'>
        <!--<div>
        	<label><input type="radio"  name="attr_controller_resource1a" value="active" checked><span>active</span></label>
        	<label><input type="radio"  name="attr_controller_resource1a" value="inactive"><span>inactive</span></label>
        </div>
        
        <div>
        	<label><input type="radio"  name="attr_controller_resource1b" value="active" checked><span>active</span></label>
        	<label><input type="radio"  name="attr_controller_resource1b" value="inactive"><span>inactive</span></label>
        </div>
        
        <div>
        	<label><input type="radio"  name="attr_controller_resource2a" value="active" checked><span>active</span></label>
        	<label><input type="radio"  name="attr_controller_resource2a" value="inactive"><span>inactive</span></label>
        </div>
       
        <div>
        	<label><input type="radio"  name="attr_controller_resource2b" value="active" checked><span>active</span></label>
        	<label><input type="radio"  name="attr_controller_resource2b" value="inactive"><span>inactive</span></label>
        </div>
        
        <div>
        	<label><input type="radio"  name="attr_controller_resource3a" value="active" checked><span>active</span></label>
        	<label><input type="radio"  name="attr_controller_resource3a" value="inactive"><span>inactive</span></label>
        </div>
        
        <div>
        	<label><input type="radio"  name="attr_controller_resource3b" value="active" checked><span>active</span></label>
        	<label><input type="radio"  name="attr_controller_resource3b" value="inactive"><span>inactive</span></label>
        </div>
        
        <div>
        	<label><input type="radio"  name="attr_controller_resource4a" value="active" checked><span>active</span></label>
        	<label><input type="radio"  name="attr_controller_resource4a" value="inactive"><span>inactive</span></label>
        </div>
        
        <div>
        	<label><input type="radio"  name="attr_controller_resource4b" value="active" checked><span>active</span></label>
        	<label><input type="radio"  name="attr_controller_resource4b" value="inactive"><span>inactive</span></label>
        </div>-->  
    	<ul>
    		<li>
    			<label><input type="text" name="attr_resource1_txt"/></label>
    			<div class="sheet-styled-select2">
    				<ul>
    					<li><label class="sheet-result_r1a"><input type="checkbox" name="attr_resource1a" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
    					<li><label class="sheet-result_r1b"><input type="checkbox" name="attr_resource1b" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
    				</ul>
    			</div>
    			<div class="sheet-addpadding">
    			    <button type="roll" value="!power --whisper|gm --name|Reset resource [@{resource1_txt}](!resource_reset,@{character_id},resource1)" name="reset_res1">Request reset</button>
    		    </div>
    		</li>
    		<li>
    			<label><input type="text" name="attr_resource2_txt"/></label>
    			<div class="sheet-styled-select2">
    				<ul>
    					<li><label class="sheet-result_r2a"><input type="checkbox" name="attr_resource2a" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
    					<li><label class="sheet-result_r2b"><input type="checkbox" name="attr_resource2b" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
    				</ul>
    			</div>
    			<div class="sheet-addpadding">
    			    <button type="roll" value="!power --whisper|gm --name|Reset resource [@{resource1_txt}](!resource_reset,@{character_id},resource2)" name="reset_res2">Request reset</button>
    		    </div>
    		</li>
    		<li>
    			<label><input type="text" name="attr_resource3_txt"/></label>
    			<div class="sheet-styled-select2">
    				<ul>
    					<li><label class="sheet-result_r3a"><input type="checkbox" name="attr_resource3a" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
    					<li><label class="sheet-result_r3b"><input type="checkbox" name="attr_resource3b" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
    				</ul>
    			</div>
    			<div class="sheet-addpadding">
    			    <button type="roll" value="!power --whisper|gm --name|Reset resource [@{resource1_txt}](!resource_reset,@{character_id},resource3)" name="reset_res3">Request reset</button>
    		    </div>
    		</li>
    		<li>
    		    <label><input type="text" name="attr_resource4_txt"/></label>
    			<div class="sheet-styled-select2">
    				<ul>
    					<li><label class="sheet-result_r4a"><input type="checkbox" name="attr_resource4a" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
    					<li><label class="sheet-result_r4b"><input type="checkbox" name="attr_resource4b" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
    				</ul>
    			</div>
    			<div class="sheet-addpadding">
    			    <button type="roll" value="!power --whisper|gm --name|Reset resource [@{resource1_txt}](!resource_reset,@{character_id},resource4)" name="reset_res4">Request reset</button>
    		    </div>
    		</li>
    	</ul>
    </div>
    <div class ="sheet-item-stress_title sheet-rotated">Stress</div>
    <div class ="sheet-griditem sheet-item-stress_body">
        <ul>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="afraid">Afraid</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_afraid" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_afraid" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_afraid" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_afraid" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_afraid" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="angry">Angry</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_angry" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_angry" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_angry" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_angry" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_angry" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="anxious">Anxious</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_anxious" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_anxious" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_anxious" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_anxious" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_anxious" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="exhausted">Exhausted</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_exhausted" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_exhausted" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_exhausted" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_exhausted" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_exhausted" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="injured">Injured</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_injured" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_injured" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_injured" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_injured" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_injured" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
		</ul>     
    </div>
    <div class ="sheet-item-h">Notes

    </div>
</div>

<rolltemplate class="sheet-rolltemplate-cortex_roll">
    <div class="sheet-rolltemplate-container">
		<div class="sheet-rolltemplate-header">Cortex Roll</div>
		<div class="sheet-rolltemplate-subheader">Main roll</div>
		<div class="sheet-rolltemplate-keptdice">Kept: {{kept_main_dice}}</div>
		<div class="sheet-rolltemplate-unkeptdice">{{unkept_main_dice}}</div>
		{{#kept_resource_dice}}
		<div class="arrow-container"><div class="arrow-right"></div></div>
		<div class="sheet-rolltemplate-subheader">Resources roll</div>
		<div class="sheet-rolltemplate-keptdice">Kept: {{kept_resource_dice}}</div>
		<div class="sheet-rolltemplate-unkeptdice">{{unkept_resource_dice}}</div>
		{{/kept_resource_dice}}
		<div class="sheet-rolltemplate-footer">Result: {{total}}</div>
	</div>
	{{#complications}}                             
	<div class="sheet-rolltemplate-footer2">Complications: {{complications}}</div>
	<div class="sheet-rolltemplate-footer2">Stress offered: {{stress_type}}</div>
	{{/complications}}
</rolltemplate>


<script type='text/worker'>
    
    on('change:affiliation change:role' ,(event)=>{
        let params = {}
	    params['calling_attribute'] = event.sourceAttribute;
	    params['action'] = "add";
        getAttrs(['main_dice','main_diceroll',event.newValue], function (values) {
            let set_attr_obj = {}
	        let rr= {};
	        rr[event.newValue] = values[event.newValue];
	        params['calling_attribute_value'] = rr;
	        params['current_dice_pool'] = values['main_dice'];
	        params['dice_roll'] = values['main_diceroll'];
	        params['dice_set'] = "main_dice";
            params['target_attr'] = "controller_";
            process_change(params);
        });
    });
    
    on('change:stress' ,(event)=>{
        let params = {}
	    params['calling_attribute'] = event.sourceAttribute;
	    params['action'] = "add";
        getAttrs(['stress_dice','stress_diceroll',event.newValue], function (values) {
            let set_attr_obj = {}
	        let rr= {};
	        rr[event.newValue] = values[event.newValue];
	        params['calling_attribute_value'] = rr;
	        params['current_dice_pool'] = values['stress_dice'];
	        params['dice_roll'] = values['stress_diceroll'];
	        params['dice_set'] = "stress_dice";
            params['target_attr'] = "xcontroller_";
            console.log(params);
            process_change(params);
        });
    });
    
    on('change:distinction' ,(event)=>{
        let params = {};
        params['calling_attribute'] = event.sourceAttribute;
        params['action'] = "add";
        var name = event.newValue + "_txt";
        getAttrs(['main_dice','main_diceroll',event.newValue, name], function (values) {
            let rr= {};
            rr[values[name]] = values[event.newValue];
            if (values[event.newValue]==="0"){
                params['action'] = "delete";
            }
            params['calling_attribute_value'] = rr;
            params['current_dice_pool'] = values['main_dice'];
            params['dice_roll'] = values['main_diceroll'];
            params['dice_set'] = "main_dice";
            params['target_attr'] = "controller_";
            process_change(params);
        });
    });
    
    on('change:resource1a change:resource1b change:resource2a change:resource2b change:resource3a change:resource3b change:resource4a change:resource4b' ,(event)=>{
        let params = {};
        params['calling_attribute'] = event.sourceAttribute;
        if(event.newValue === '0') {
                  params['action'] = "delete";
        }  else {
                  params['action'] = "add";
        }
        var name = event.sourceAttribute.slice(0, -1) + "_txt";

        getAttrs(['resource_dice','resource_diceroll',event.newValue, name], function (values) {
            var name = event.sourceAttribute.slice(0, -1) + "_txt";
            let rr= {};
            rr[values[name]] = event.newValue;
            
            params['calling_attribute_value'] = rr;
            params['current_dice_pool'] = values['resource_dice'];
            params['dice_roll'] = values['resource_diceroll'];
            params['dice_set'] = "resource_dice";
            params['target_attr'] = "resource_";
            process_change(params);
        });
    });
    
    function process_change(params) {
   
        let set_attr_obj = {};
        control_settings = {'d4':0,'d6':0,'d8':0,'d10':0,'d12':0};
        dice_pool = alter_dice_pool(params);
        set_attr_obj[params['dice_set']] = JSON.stringify(dice_pool);
       
		for (key of Object.keys(dice_pool)) {
		    
		    for (dice_size of Object.values(dice_pool[key])) {
		        
		        if (dice_size in control_settings) {
		           control_settings[dice_size] = control_settings[dice_size] +1;
		        }
		    }
		}
		if (params['dice_roll'] == undefined){
		} else {
    		old_settings = JSON.parse(params['dice_roll'])
    		if (Object.keys(old_settings).length === 0) {
    		    max_old_settings = 0;
    		} else {
    	        max_old_settings = Object.values(JSON.parse(params['dice_roll'])).reduce(function(a, b) {return Math.max(a, b);});
    		}
    		max_new_settings = Object.values(control_settings).reduce(function(a, b) {return Math.max(a, b);});
    		set_attr_obj[params['dice_set']+'roll'] = JSON.stringify(control_settings);
    		
    		for (entry of Object.entries(control_settings)) {
    		    for (i=1; i<Math.max(max_old_settings,max_new_settings)+1; i++) {
    		        if (i <= entry[1]) {
    		            set_attr_obj[params['target_attr'] + entry[0] +"_" + i] = "two";
    		        } else {
    		            set_attr_obj[params['target_attr'] + entry[0] +"_" + i] = "one";
    		        }
    		    }
    		}
		}
		setAttrs(set_attr_obj);
    };
    
    function alter_dice_pool(params) {
        
        var dice_pool = JSON.parse(params['current_dice_pool']);
        if (params['action']==='delete') {
            delete dice_pool[params['calling_attribute']];  
        }
        if (params['action']==='add') {
            dice_pool[params['calling_attribute']] = params['calling_attribute_value'];  
        }
        return dice_pool;
    };
    
    on ('change:plot_points_spent',(event)=>{
        console.log('plot points spent sheet worker ran');
        let setAttr_obj = {};
        var int_ppt = parseInt(event.newValue);
        getAttrs(['plot_points'], function(values) {
            if (Number.isInteger(int_ppt) && int_ppt > 0) {
                if (int_ppt > values.plot_points) {
                    setAttr_obj['plot_points_spent'] = values.plot_points;   
                } else {
                     setAttr_obj['plot_points_spent'] = int_ppt;
                }
            } else {
            	setAttr_obj['plot_points_spent'] = 0;
            }  
            setAttrs(setAttr_obj);
        });
    });
</script>