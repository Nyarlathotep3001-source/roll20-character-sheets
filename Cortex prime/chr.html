<div class="sheet-container">
    <div class ="sheet-item-header">
        <input type='hidden' class='controller_d12_1' name='attr_controller_d12_1' value='one'>
        <input type='hidden' class='controller_d12_2' name='attr_controller_d12_2' value='one'>
        <input type='hidden' class='controller_d10_1' name='attr_controller_d10_1' value='one'>
        <input type='hidden' class='controller_d10_2' name='attr_controller_d10_2' value='one'>
        <input type='hidden' class='controller_d8_1' name='attr_controller_d8_1' value='one'>
        <input type='hidden' class='controller_d8_2' name='attr_controller_d8_2' value='one'>
        <input type='hidden' class='controller_d8_3' name='attr_controller_d8_3' value='one'>
        <input type='hidden' class='controller_d6_1' name='attr_controller_d6_1' value='one'>
        <input type='hidden' class='controller_d6_2' name='attr_controller_d6_2' value='one'>
        <input type='hidden' class='controller_d4_1' name='attr_controller_d4_1' value='one'>
        <input type='hidden' class='controller_d4_2' name='attr_controller_d4_2' value='one'>
        <input type='hidden' class='controller_d4_3' name='attr_controller_d4_3' value='one'>
        
        <input type='hidden' class='resource_d10_1' name='attr_resource_d10_1' value='one'>
        <input type='hidden' class='resource_d10_2' name='attr_resource_d10_2' value='one'>
        <input type='hidden' class='resource_d10_3' name='attr_resource_d10_3' value='one'>
        <input type='hidden' class='resource_d10_4' name='attr_resource_d10_4' value='one'>
        <input type='hidden' class='resource_d10_5' name='attr_resource_d10_5' value='one'>
        <input type='hidden' class='resource_d10_6' name='attr_resource_d10_6' value='one'>
        <input type='hidden' class='resource_d8_1' name='attr_resource_d8_1' value='one'>
        <input type='hidden' class='resource_d8_2' name='attr_resource_d8_2' value='one'>
        <input type='hidden' class='resource_d8_3' name='attr_resource_d8_3' value='one'>
        <input type='hidden' class='resource_d8_4' name='attr_resource_d8_4' value='one'>
        <input type='hidden' class='resource_d8_5' name='attr_resource_d8_5' value='one'>
        <input type='hidden' class='resource_d8_6' name='attr_resource_d8_6' value='one'>
        <input type='hidden' class='resource_d6_1' name='attr_resource_d6_1' value='one'>
        <input type='hidden' class='resource_d6_2' name='attr_resource_d6_2' value='one'>
        <input type='hidden' class='resource_d6_3' name='attr_resource_d6_3' value='one'>
        <input type='hidden' class='resource_d6_4' name='attr_resource_d6_4' value='one'>
        <input type='hidden' class='resource_d6_5' name='attr_resource_d6_5' value='one'>
        <input type='hidden' class='resource_d6_6' name='attr_resource_d6_6' value='one'>
        <label><input type="radio" name="attr_resource1a_show" value="active">r1a</label></li>
        <label><input type="radio" name="attr_resource1a_show" value="inactive">r1a</label></li>
        <label><input type="radio" name="attr_resource1b_show" value="active">r1b</label></li>
        <label><input type="radio" name="attr_resource1b_show" value="inactive">r1b</label></li>
        <label><input type="radio" name="attr_resource2a_show" value="active">r2a</label></li>
        <label><input type="radio" name="attr_resource2a_show" value="inactive">r2a</label></li>
        <label><input type="radio" name="attr_resource2b_show" value="active">r2b</label></li>
        <label><input type="radio" name="attr_resource2b_show" value="inactive">r2b</label></li>
        <label><input type="radio" name="attr_resource3a_show" value="active">r3a</label></li>
        <label><input type="radio" name="attr_resource3a_show" value="inactive">r3a</label></li>
        <label><input type="radio" name="attr_resource3b_show" value="active">r3b</label></li>
        <label><input type="radio" name="attr_resource3b_show" value="inactive">r3b</label></li>
        <label><input type="radio" name="attr_resource4a_show" value="active">r4a</label></li>
        <label><input type="radio" name="attr_resource4a_show" value="inactive">r4a</label></li>
        <label><input type="radio" name="attr_resource4b_show" value="active">r4b</label></li>
        <label><input type="radio" name="attr_resource4b_show" value="inactive">r4b</label></li>
        
        <!--<div class='contain'>
            <h4>Controllers</h4>
            <label class='control1-label'><input type='radio' name='attr_controller_d12_1' value='one' checked><span>d12_1:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d12_1' value='two'><span>d12_1:show</span></label>
            <label class='control1-label'><input type='radio' name='attr_controller_d12_2' value='one' checked><span>d12_2:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d12_2' value='two'><span>d12_2:show</span></label>
            <label class='control1-label'><input type='radio' name='attr_controller_d10_1' value='one' checked><span>d10_1:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d10_1' value='two'><span>d10_1:show</span></label>
            <label class='control1-label'><input type='radio' name='attr_controller_d10_2' value='one' checked><span>d10_2:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d10_2' value='two'><span>d10_2:show</span></label>
			<label class='control1-label'><input type='radio' name='attr_controller_d8_1' value='one' checked><span>d8_1:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d8_1' value='two'><span>d8_1:show</span></label>
            <label class='control1-label'><input type='radio' name='attr_controller_d8_2' value='one' checked><span>d8_2:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d8_2' value='two'><span>d8_2:show</span></label>
			<label class='control1-label'><input type='radio' name='attr_controller_d8_3' value='one' checked><span>d8_3:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d8_3' value='two'><span>d8_3:show</span></label>
			<label class='control1-label'><input type='radio' name='attr_controller_d6_1' value='one' checked><span>d6_1:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d6_1' value='two'><span>d6_1:show</span></label>
            <label class='control1-label'><input type='radio' name='attr_controller_d6_2' value='one' checked><span>d6_2:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d6_2' value='two'><span>d6_2:show</span></label>
			<label class='control1-label'><input type='radio' name='attr_controller_d4_1' value='one' checked><span>d4_1:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d4_1' value='two'><span>d4_1:show</span></label>
            <label class='control1-label'><input type='radio' name='attr_controller_d4_2' value='one' checked><span>d4_2:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d4_2' value='two'><span>d4_2:show</span></label>
			<label class='control1-label'><input type='radio' name='attr_controller_d4_3' value='one' checked><span>d4_3:hide</span></label>
            <label class='control2-label'><input type='radio' name='attr_controller_d4_3' value='two'><span>d4_3:show</span></label>
        </div> -->
        <Span class="sheet-header1">Dice Pool</Span>
        <div class="sheet-header2">Main dice</div>
        <div class='diceblock'>
            <span class='receiver_d12_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d12_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="60" height="60" border="0" align="middle" /></span>
			<span class='receiver_d10_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
			<span class='receiver_d10_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d8_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d8_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d8_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d6_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d6_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d4_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d4_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="60" height="60" border="0" align="middle" /></span>
            <span class='receiver_d4_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="60" height="60" border="0" align="middle" /></span>
        </div>
        <Span class="sheet-header2">Resources dice</Span>
        <div class='diceblock'>
            <span class='rresource_d10_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d10_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
    		<span class='rresource_d10_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
    		<span class='rresource_d10_4'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
    		<span class='rresource_d10_5'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
    		<span class='rresource_d10_6'><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_4'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_5'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d8_6'><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_1'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_2'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_3'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_4'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_5'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
            <span class='rresource_d6_6'><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="60" height="60" border="0" align="middle" /></span>
        </div>
    </div>
    <div class ="sheet-item-plot">
        
    </div>
    <div class ="sheet-item-roll">
            <input name='attr_main_dice' type='text' value='{}'>
            <input name='attr_main_diceroll' type='text' value='{"d4":0,"d6":0,"d8":0,"d10":0,"d12":0}'>
            <input name='attr_resource_dice' type='text' value='{}'>
            <input name='attr_resource_diceroll' type='text' value='{"d4":0,"d6":0,"d8":0,"d10":0,"d12":0}'>
            <input name='attr_stress_dice' type='text' value='{}'> 
            <input name='attr_plot_points' type='text' value=0>
            <label><input name='attr_resource1a' type='text' value=0>resource1a</lable>
            <button type="roll" value="!cortex_custom_roll" name="call_cortex_roll">Cortex roll</button>
    </div>
    <div class ="sheet-item-affiliations_title sheet-rotated">Affiliations</div>
    <div class ="sheet-griditem sheet-item-affiliations_body">
        <ul>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_affiliation" value="solo">Solo</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_solo" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_solo" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_solo" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_solo" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_solo" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_affiliation" value="partner">Partner</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_partner" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_partner" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_partner" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_partner" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_partner" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_affiliation" value="squad">Squad</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_squad" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_squad" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_squad" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_squad" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_squad" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
        </ul> 
    </div>
    <div class ="sheet-item-distinctions_title sheet-rotated">Distinctions</div>
    <div class ="sheet-griditem sheet-item-distinctions_body">
        <ul>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_distinction" value="distinction1"><input type="text" name="attr_distinction1_txt"/></label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_distinction1" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_distinction1" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_distinction" value="distinction2"><input type="text" name="attr_distinction2_txt"/></label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_distinction2" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_distinction2" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_distinction" value="distinction3"><input type="text" name="attr_distinction3_txt"/></label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_distinction3" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_distinction3" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			    <label class="sheet-dicepicker"><input type="radio" name="attr_distinction" value="distinction4">No distinction used</label>
			    <input name='attr_distinction4' type="hidden" value='0'>
			<li>
			    
			</li>
		</ul>
    </div>
    <div class ="sheet-item-roles_title sheet-rotated">Roles</div>
    <div class ="sheet-griditem sheet-item-roles_body">
        <ul>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="forensics">Forensics</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_forensics" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_forensics" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_forensics" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_forensics" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_forensics" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="investigation">Investigation</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_investigation" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_investigation" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_investigation" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_investigation" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_investigation" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="legal">Legal</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_legal" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_legal" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_legal" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_legal" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_legal" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="medicine">Medicine</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_medicine" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_medicine" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_medicine" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_medicine" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_medicine" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="psychology">Psychology</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_psychology" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_psychology" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_psychology" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_psychology" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_psychology" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="tactics">Tactics</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_tactics" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_tactics" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_tactics" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_tactics" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_tactics" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_role" value="technology">Technology</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_technology" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_technology" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_technology" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_technology" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_technology" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
        </ul> 
    </div>
    <div class ="sheet-item-talents_title sheet-rotated">Talents</div>
    <div class ="sheet-griditem sheet-item-talents_body">
        <ul>
            <li><label class="sheet-dicepicker"><input type="text" name="attr_talent1"/></label></li>
            <li><label class="sheet-dicepicker"><input type="text" name="attr_talent2"/></label></li>
            <li><label class="sheet-dicepicker"><input type="text" name="attr_talent3"/></label></li>
        </ul>
    </div>
    <div class ="sheet-item-resources_title sheet-rotated">Resources</div>
    <div class ="sheet-griditem sheet-item-resources_body">
        <ul>
			<li>
				<label class="sheet-dicepicker"><input type="text" name="attr_resource1_txt"/><button type="roll" value="!power --whisper|gm --name|Reset resource [@{resource1_txt}](!resource_reset,@{character_id},resource1)" name="reset_res1">Request reset</button></label>
				<div class="sheet-styled-select2">
					<ul>
						<li><label><input type="checkbox" name="attr_resource1a" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="checkbox" name="attr_resource1b" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="text" name="attr_resource2_txt"/></label>
				<div class="sheet-styled-select2">
					<ul>
						<li><label><input type="checkbox" name="attr_resource2a" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="checkbox" name="attr_resource2b" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="text" name="attr_resource3_txt"/></label>
				<div class="sheet-styled-select2">
					<ul>
						<li><label><input type="checkbox" name="attr_resource3a" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="checkbox" name="attr_resource3b" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="text" name="attr_resource4_txt"/></label>
				<div class="sheet-styled-select2">
					<ul>
						<li><label><input type="checkbox" name="attr_resource4a" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="checkbox" name="attr_resource4b" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
		</ul>
    </div>
    <div class ="sheet-item-stress_title sheet-rotated">Stress</div>
    <div class ="sheet-griditem sheet-item-stress_body">
        <ul>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="afraid">Afraid</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_afraid" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_afraid" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_afraid" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_afraid" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_afraid" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="angry">Angry</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_angry" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_angry" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_angry" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_angry" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_angry" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="anxious">Anxious</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_anxious" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_anxious" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_anxious" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_anxious" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_anxious" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="exhausted">Exhausted</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_exhausted" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_exhausted" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_exhausted" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_exhausted" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_exhausted" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
			<li>
				<label class="sheet-dicepicker"><input type="radio" name="attr_stress" value="injured">Injured</label>
				<div class="sheet-styled-select">
					<ul>
						<li><label><input type="radio" name="attr_injured" value="d4"><img src="http://www.thefirstcity.co.uk/rpg/dice/d4.jpg" alt="d4" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_injured" value="d6"><img src="http://www.thefirstcity.co.uk/rpg/dice/d6.jpg" alt="d6" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_injured" value="d8"><img src="http://www.thefirstcity.co.uk/rpg/dice/d8.jpg" alt="d8" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_injured" value="d10"><img src="http://www.thefirstcity.co.uk/rpg/dice/d10.jpg" alt="d10" width="32" height="32" border="0" align="middle" /></label></li>
						<li><label><input type="radio" name="attr_injured" value="d12"><img src="http://www.thefirstcity.co.uk/rpg/dice/d12.jpg" alt="d12" width="32" height="32" border="0" align="middle" /></label></li>
					</ul>
				</div>
			</li>
		</ul>     
    </div>
    <div class ="sheet-item-h">Notes

    </div>
</div>

<rolltemplate class="sheet-rolltemplate-cortex_roll">
    <div class="sheet-rolltemplate-container">
		<div class="sheet-rolltemplate-header">Cortex Roll</div>
		<div class="sheet-rolltemplate-subheader">Main roll</div>
		<div class="sheet-rolltemplate-keptdice">Kept: {{kept_main_dice}}</div>
		<div class="sheet-rolltemplate-unkeptdice">{{unkept_main_dice}}</div>
		{{#kept_resource_dice}}
		<div class="arrow-container"><div class="arrow-right"></div></div>
		<div class="sheet-rolltemplate-subheader">Resources roll</div>
		<div class="sheet-rolltemplate-keptdice">Kept: {{kept_resource_dice}}</div>
		<div class="sheet-rolltemplate-unkeptdice">{{unkept_resource_dice}}</div>
		{{/kept_resource_dice}}
		<div class="sheet-rolltemplate-footer">Result: {{total}}</div>
	</div>
	{{#complications}}                             
	<div class="sheet-rolltemplate-footer2">Complications: {{complications}}</div>
	{{/complications}}
</rolltemplate>


<script type='text/worker'>
    /*on('change:affiliation change:role change:stress' ,(event)=>{
        //onsole.log(`============================ mainpool setting detected ============================`);
        //console.log(event);
        //console.log(`========================================================`);
        let params = {}
	    params['calling_attribute'] = event.sourceAttribute;
	    params['action'] = "add";
	    var name = event.newValue + '_txt'
        getAttrs(['main_dice','main_diceroll',event.newValue, name], function (values) {
            let set_attr_obj = {}
            //console.log(values[name]);
	        //console.log(`============================ raw values ============================`);
	        //console.log(values);
	        //console.log(`====================================================================`);
	        //entries = Object.entries(values);
	        //console.log(`============================ entry array values ============================`);
	        //console.log(entries);
	        //console.log(`====================================================================`);
	        let rr= {};
	        rr[event.newValue] = values[event.newValue];
	        params['calling_attribute_value'] = rr;
	        params['current_dice_pool'] = values['main_dice'];
	        params['main_dice_roll'] = values['main_die_roll'];
	        //console.log(`============================ parameter contents ====================`);
            //console.log(params);
            //console.log(`====================================================================`);
            console.log(`============================ main_dice parameters ============================`);
            console.log(params);
            console.log(`========================================================`);
            //console.log(alter_dice_pool(params));
            
            control_settings = {'d4':0,'d6':0,'d8':0,'d10':0,'d12':0};
            
            main_dice_pool = alter_dice_pool(params);
            set_attr_obj['main_dice'] = JSON.stringify(main_dice_pool);
            //console.log(main_dice_pool);
			for (key of Object.keys(main_dice_pool)) {
			    //console.log(main_dice_pool[key]);
			    for (dice_size of Object.values(main_dice_pool[key])) {
			        //console.log(dice_size);
			        if (dice_size in control_settings) {
			           control_settings[dice_size] = control_settings[dice_size] +1;
			        }
			    }
			}
			max_old_settings = Object.values(JSON.parse(values['main_diceroll'])).reduce(function(a, b) {return Math.max(a, b);});
			max_new_settings = Object.values(control_settings).reduce(function(a, b) {return Math.max(a, b);});
			//console.log(control_settings);
			//setAttrs('diceroll':JSON.stringify(control_settings));
			//console.log(JSON.parse(values['main_diceroll']));
			//console.log(control_settings);
			//console.log(JSON.stringify(control_settings));
			//console.log(max_old_settings);
			//console.log(max_new_settings);
			set_attr_obj['main_diceroll'] = JSON.stringify(control_settings);
			
			for (entry of Object.entries(control_settings)) {
			    for (i=1; i<Math.max(max_old_settings,max_new_settings)+1; i++) {
			        if (i <= entry[1]) {
			            //console.log("_" + entry[0] +"_" + i + " :two");
			            set_attr_obj["controller_" + entry[0] +"_" + i] = "two";
			        } else {
			            //console.log("_" + entry[0] +"_" + i + " :one");
			            set_attr_obj["controller_" + entry[0] +"_" + i] = "one";
			        }
			    }
			}
			//console.log(set_attr_obj);
			console.log(set_attr_obj);
			
			setAttrs(set_attr_obj);
        });
    });*/
    
    on('change:affiliation change:role' ,(event)=>{
        let params = {}
	    params['calling_attribute'] = event.sourceAttribute;
	    params['action'] = "add";
        getAttrs(['main_dice','main_diceroll',event.newValue], function (values) {
            let set_attr_obj = {}
	        //console.log(`============================ raw values ============================`);
	        //console.log(event.newValue);
	        //console.log(values);
	        //console.log(`====================================================================`);
	        //entries = Object.entries(values);
	        //console.log(`============================ entry array values ============================`);
	        //console.log(entries);
	        //console.log(`====================================================================`);
	        let rr= {};
	        rr[event.newValue] = values[event.newValue];
	        params['calling_attribute_value'] = rr;
	        params['current_dice_pool'] = values['main_dice'];
	        params['dice_roll'] = values['main_diceroll'];
	        params['dice_set'] = "main_dice";
            params['target_attr'] = "controller_";
            //console.log(`============================ raw values ============================`);
	        //console.log(params);
	        //console.log(`====================================================================`);
            
            process_change(params);
        });
    });
    
    on('change:stress' ,(event)=>{
        let params = {}
	    params['calling_attribute'] = event.sourceAttribute;
	    params['action'] = "add";
        getAttrs(['stress_dice','stress_diceroll',event.newValue], function (values) {
            let set_attr_obj = {}
	        //console.log(`============================ raw values ============================`);
	        //console.log(event.newValue);
	        //console.log(values);
	        //console.log(`====================================================================`);
	        //entries = Object.entries(values);
	        //console.log(`============================ entry array values ============================`);
	        
	        //console.log(entries);
	        //console.log(`====================================================================`);
	        let rr= {};
	        rr[event.newValue] = values[event.newValue];
	        params['calling_attribute_value'] = rr;
	        params['current_dice_pool'] = values['stress_dice'];
	        params['dice_roll'] = values['stress_diceroll'];
	        params['dice_set'] = "stress_dice";
            params['target_attr'] = "xcontroller_";
            //console.log(`============================ raw values ============================`);
	        //console.log(params);
	        //console.log(`====================================================================`);
            
            process_change(params);
        });
    });
    
    on('change:distinction' ,(event)=>{
        //onsole.log(`============================ mainpool setting detected ============================`);
        //console.log(event);
        //console.log(`========================================================`);
        let params = {};
        params['calling_attribute'] = event.sourceAttribute;
        params['action'] = "add";
        var name = event.newValue + "_txt";
        //console.log(`============================ distinction parameters ============================`);
        //console.log(params);
        //console.log(`========================================================`);
        getAttrs(['main_dice','main_diceroll',event.newValue, name], function (values) {
            let rr= {};
            rr[values[name]] = values[event.newValue];
            if (values[event.newValue]==="0"){
                params['action'] = "delete";
            }
            params['calling_attribute_value'] = rr;
            params['current_dice_pool'] = values['main_dice'];
            params['dice_roll'] = values['main_diceroll'];
            params['dice_set'] = "main_dice";
            params['target_attr'] = "controller_";
            console.log(`============================ distinction parameters ============================`);
            console.log(params);
            console.log(`========================================================`);
          
            process_change(params);
        });
    });
    
    on('change:resource1a change:resource1b change:resource2a change:resource2b change:resource3a change:resource3b change:resource4a change:resource4b' ,(event)=>{
        //console.log(`============================ mainpool setting detected ============================`);
        //console.log(event);
        //console.log(`========================================================`);
        let params = {};
        params['calling_attribute'] = event.sourceAttribute;
        if(event.newValue === '0') {
                  params['action'] = "delete";
                  //console.log(`============================ not checked ============================`);
                  //console.log(params);
                  //console.log(`========================================================`);
        }  else {
                  params['action'] = "add";
                  //console.log(`============================ checked ============================`);
                  //console.log(`========================================================`);
                  //console.log(params);
        }
        var name = event.sourceAttribute.slice(0, -1) + "_txt";
        //console.log(`============================ name for resource text ============================`);
        //console.log(name);
        //console.log(`========================================================`);
        getAttrs(['resource_dice','resource_diceroll',event.newValue, name], function (values) {
            var name = event.sourceAttribute.slice(0, -1) + "_txt";
            console.log(`============================ name for resource text ============================`);
            console.log(values[name]);
            console.log(`========================================================`);
            let rr= {};
            rr[values[name]] = event.newValue;
            
            params['calling_attribute_value'] = rr;
            params['current_dice_pool'] = values['resource_dice'];
            params['dice_roll'] = values['resource_diceroll'];
            params['dice_set'] = "resource_dice";
            params['target_attr'] = "resource_";
            console.log(`============================ resource parameters ============================`);
            console.log(params);
            console.log(`========================================================`);
          
            process_change(params);
        });
    });
    
    on('change:resource1a_show change:resource1b_show change:resource2a_show change:resource2b_show change:resource3a_show change:resource3b_show change:resource4a_show change:resource4b_show',(event)=>{
        console.log('fired resource1.show event');
        console.log('Souceattribute:' + event.sourceAttribute);
        var mod_name = event.sourceAttribute.split("_")
        console.log('Sourceattribute_mod:' + mod_name[0]);
        console.log('NewValue:'+ event.newValue);
        if (event.newValue ==='inactive') {
            let attr_to_set = {};
            attr_to_set[mod_name[0]] = '0';
            console.log(attr_to_set);
            setAttrs(attr_to_set);    
        } 
    });
    /*on('change:res1a change:res1b change:res2a change:res2b change:res3a change:res3b change:res4a change:res4b' ,(event)=>{
        //console.log(`============================ mainpool setting detected ============================`);
        //console.log(event);
        //console.log(`========================================================`);
        let params = {}
    	params['calling_attribute'] = event.sourceAttribute;
    	if(event.newValue === '0') {
                  params['action'] = "delete";
                  //console.log(`============================ not checked ============================`);
                  //console.log(params);
                  //console.log(`========================================================`);
        }  else {
                  params['action'] = "add";
                  //console.log(`============================ checked ============================`);
                  //console.log(`========================================================`);
                  //console.log(params);
        }
        getAttrs(['resource_dice','resource_diceroll'], function (values) {
            let set_attr_obj = {}
    	    //console.log(`============================ raw values ============================`);
    	    //console.log(values);
    	    //console.log(`====================================================================`);
    	    //entries = Object.entries(values);
    	    //console.log(`============================ entry array values ============================`);
    	    //console.log(entries);
    	    //console.log(`====================================================================`);
    	       		
            params['calling_attribute_value'] = event.newValue;;
    	    params['current_dice_pool'] = values['resource_dice'];
    	    //console.log(`============================ parameter contents ====================`);
            //console.log(params);
            //console.log(`====================================================================`);
            //console.log(`============================ resource_dice parameters ============================`);
            //console.log(params);
            //console.log(`========================================================`);
            //console.log(alter_dice_pool(params));
            
            control_settings = {'d4':0,'d6':0,'d8':0,'d10':0,'d12':0};
            
            resource_dice_pool = alter_dice_pool(params);
            set_attr_obj['resource_dice'] = JSON.stringify(resource_dice_pool);
            //console.log(resource_dice_pool);
    		for (dice_size of Object.values(resource_dice_pool)) {
		        //console.log(dice_size);
		        if (dice_size in control_settings) {
		           control_settings[dice_size] = control_settings[dice_size] +1;
    		    }
    		}
    		max_old_settings = Object.values(JSON.parse(values['resource_diceroll'])).reduce(function(a, b) {return Math.max(a, b);});
    		max_new_settings = Object.values(control_settings).reduce(function(a, b) {return Math.max(a, b);});
    		//console.log(control_settings);
    		//setAttrs('diceroll':JSON.stringify(control_settings));
    		console.log(JSON.parse(values['resource_diceroll']));
    		console.log(control_settings);
    		//console.log(JSON.stringify(control_settings));
    		console.log(max_old_settings);
    		console.log(max_new_settings);
    		set_attr_obj['resource_diceroll'] = JSON.stringify(control_settings);
    		
    		for (entry of Object.entries(control_settings)) {
    		    for (i=1; i<Math.max(max_old_settings,max_new_settings)+1; i++) {
    		        if (i <= entry[1]) {
    		            //console.log("_" + entry[0] +"_" + i + " :two");
    		            set_attr_obj["resource_" + entry[0] +"_" + i] = "two";
    		        } else {
    		            //console.log("_" + entry[0] +"_" + i + " :one");
    		            set_attr_obj["resource_" + entry[0] +"_" + i] = "one";
    		        }
    		    }
    		}
    		console.log(set_attr_obj);
    		setAttrs(set_attr_obj);
        });
    });
    */
    function process_change(params) {
   
        let set_attr_obj = {};
        control_settings = {'d4':0,'d6':0,'d8':0,'d10':0,'d12':0};
        dice_pool = alter_dice_pool(params);
        set_attr_obj[params['dice_set']] = JSON.stringify(dice_pool);
       
		for (key of Object.keys(dice_pool)) {
		    
		    for (dice_size of Object.values(dice_pool[key])) {
		        
		        if (dice_size in control_settings) {
		           control_settings[dice_size] = control_settings[dice_size] +1;
		        }
		    }
		}
		
	    max_old_settings = Object.values(JSON.parse(params['dice_roll'])).reduce(function(a, b) {return Math.max(a, b);});
		max_new_settings = Object.values(control_settings).reduce(function(a, b) {return Math.max(a, b);});
		//setAttrs('diceroll':JSON.stringify(control_settings));
		//console.log(JSON.parse(values['main_diceroll']));
		//console.log(control_settings);
		//console.log(JSON.stringify(control_settings));
		//console.log(control_settings);
		//console.log(max_old_settings);
		//console.log(max_new_settings);
		set_attr_obj[params['dice_set']+'roll'] = JSON.stringify(control_settings);
		
		for (entry of Object.entries(control_settings)) {
		    for (i=1; i<Math.max(max_old_settings,max_new_settings)+1; i++) {
		        if (i <= entry[1]) {
		            //console.log("_" + entry[0] +"_" + i + " :two");
		            set_attr_obj[params['target_attr'] + entry[0] +"_" + i] = "two";
		        } else {
		            //console.log("_" + entry[0] +"_" + i + " :one");
		            set_attr_obj[params['target_attr'] + entry[0] +"_" + i] = "one";
		        }
		    }
		}
		//console.log(`============================ dice parameters ============================`);
		//console.log(set_attr_obj);
		//console.log(`==================================================================================`);
		setAttrs(set_attr_obj);
		
    };
    
    function alter_dice_pool(params) {
        
        var dice_pool = JSON.parse(params['current_dice_pool']);
        if (params['action']==='delete') {
            delete dice_pool[params['calling_attribute']];  
        }
        if (params['action']==='add') {
            dice_pool[params['calling_attribute']] = params['calling_attribute_value'];  
        }
        return dice_pool;
    };
    

</script>